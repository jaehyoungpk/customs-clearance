# 🚀 통합 무역 정보 상담 시스템 CLI 가이드

한국 관세법 RAG 시스템과 일반 무역 정보 시스템을 통합한 CLI 인터페이스입니다.

## 📋 시스템 개요

### 🔧 2개 에이전트 시스템
1. **관세법 RAG 에이전트**: 정확한 법률 정보 제공 (관세법, 관세법시행령, 관세법시행규칙)
2. **일반 무역 정보 에이전트**: 실용적 무역 가이드 (CSV 데이터 기반)

### 🎯 주요 기능
- 대화형 질의응답 시스템
- 두 에이전트 간 선택 가능
- 통합 데이터베이스 관리
- 벡터 검색 및 컨텍스트 기반 응답

## 🚀 사용 방법

### 1. 통합 CLI (권장)
```bash
# 통합 시스템 시작 (메뉴에서 에이전트 선택)
python -m src.rag.unified_cli

# 관세법 RAG 에이전트로 바로 시작
python -m src.rag.unified_cli --agent law

# 일반 무역 정보 에이전트로 바로 시작
python -m src.rag.unified_cli --agent trade
```

### 2. 개별 CLI (관세법 전용)
```bash
# 관세법 RAG 시스템 시작
python -m src.rag.cli --chat

# 데이터베이스 초기 설정
python -m src.rag.cli --setup

# 문서 검색
python -m src.rag.cli --search "수입신고 서류"

# 시스템 상태 확인
python -m src.rag.cli --stats
```

## 📊 통합 CLI 메뉴 구조

```
🏠 무역 정보 통합 상담 시스템 메인 메뉴
┣━━ 1. 📚 관세법 RAG 에이전트 (정확한 법률 정보)
┣━━ 2. 🌐 일반 무역 정보 에이전트 (실용적 무역 가이드)
┣━━ 3. 🗄️ 데이터베이스 관리
┃    ┣━━ 📚 관세법 데이터 로드/재로드
┃    ┣━━ 🌐 무역 정보 데이터 로드/재로드
┃    ┣━━ 📊 데이터베이스 상태 확인
┃    └━━ 🗑️ 데이터베이스 초기화
┣━━ 4. 📊 시스템 상태 확인  
┣━━ 5. ⚙️ 설정
└━━ 0. 🚪 종료
```

## 🔧 초기 설정 가이드

### 1. 환경 설정
```bash
# 환경 변수 설정 (.env 파일)
OPENAI_API_KEY=sk-proj-your-openai-api-key-here
HF_TOKEN=hf_your-huggingface-token-here  # 선택사항
```

### 2. 데이터 로드
```bash
# 통합 CLI를 통한 데이터 로드
python -m src.rag.unified_cli
# → 메뉴에서 "3. 데이터베이스 관리" 선택
# → "1. 관세법 데이터 로드/재로드" 또는 "2. 무역 정보 데이터 로드/재로드" 선택

# 또는 개별 CLI를 통한 관세법 데이터 로드
python -m src.rag.cli --setup
```

## 💬 대화형 사용 예시

### 관세법 RAG 에이전트
```
❓ 관세법 질문: 수입신고는 언제까지 해야 하나요?

🤖 관세법 전문가:
--------------------------------------------------
관세법 제241조에 따르면, 수입신고는 다음과 같이 규정되어 있습니다:

1. 수입신고 시기: 물품을 수입하려는 자는 그 물품이 보세구역에 
   반입된 후 세관장에게 수입신고를 하여야 합니다.

2. 신고 기한: 물품이 보세구역에 반입된 날부터 15일 이내에 
   수입신고를 하여야 합니다.

📚 참조된 법령 (2개):
  1. 제241조 (수입신고) - 관세법 - 유사도: 0.952
  2. 제242조 (수입신고서류) - 관세법 - 유사도: 0.847
```

### 일반 무역 정보 에이전트
```
❓ 무역 정보 질문: 철강 제품 수출시 주의사항을 알려주세요

🤖 무역 정보 전문가:
--------------------------------------------------
철강 제품 수출 시 다음 사항을 주의하셔야 합니다:

1. 반덤핑 규제: 미국, EU 등 주요국에서 한국산 철강에 대해 
   반덤핑 관세를 부과하고 있습니다.

2. HS코드 분류: 철강 제품은 HS코드 72류에 해당하며, 
   세부 품목에 따라 정확한 분류가 필요합니다.

📊 참조된 정보 (3개):
  1. 철강 반덤핑 규제 현황 | HS: 7208 | 국가: 미국 - 유사도: 0.943
  2. 철강 수출 가이드라인 | 유형: 수출제한 - 유사도: 0.891
  3. HS코드 7208 관련 규제 정보 - 유사도: 0.856
```

## ⚙️ 고급 옵션

### 검색 정확도 조정
```bash
# 유사도 임계값 설정 (0.0-1.0)
python -m src.rag.cli --chat --threshold 0.5

# 최대 참조 문서 수 설정
python -m src.rag.cli --chat --max-docs 3

# 상세 로그 출력
python -m src.rag.unified_cli --verbose
```

### 대화 중 명령어
- `quit`, `exit`, `q`: 대화 종료
- `reset`: 대화 기록 초기화

## 🗂️ 파일 구조

```
src/rag/
├── unified_cli.py          # 통합 CLI (메인)
├── cli.py                  # 관세법 전용 CLI
├── conversation_agent.py   # 관세법 RAG 에이전트
├── general_info_agent.py   # 일반 무역 정보 에이전트
├── embeddings.py          # OpenAI 임베딩
├── vector_store.py        # ChromaDB 벡터 저장소
├── retriever.py           # 관세법 검색기
├── trade_info_retriever.py # 무역 정보 검색기
└── query_normalizer.py    # 쿼리 정규화

examples/
├── interactive_test.py    # 대화형 테스트 도구
└── trade_info_example.py  # 무역 정보 사용 예제
```

## 🚨 문제 해결

### 데이터베이스가 비어있는 경우
```
⚠️ 벡터 데이터베이스가 비어있습니다.
   데이터베이스 관리 메뉴에서 데이터를 먼저 로드해주세요.
```
**해결방법**: 통합 CLI → 데이터베이스 관리 → 데이터 로드

### API 키 오류
```
❌ OPENAI_API_KEY 환경 변수가 설정되지 않았습니다.
```
**해결방법**: `.env` 파일에 올바른 API 키 설정

### 모듈 임포트 오류
**해결방법**: 프로젝트 루트 디렉토리에서 실행

## 💡 사용 팁

1. **첫 실행 시**: 통합 CLI로 시작하여 데이터를 먼저 로드하세요
2. **에이전트 선택**: 법률 정보는 관세법 RAG, 실무 정보는 일반 무역 정보 에이전트 사용
3. **검색 최적화**: 유사도 임계값을 조정하여 검색 정확도 향상
4. **대화 연속성**: 대화 기록을 활용한 연속적인 질문 가능

## 🎯 향후 개선 사항

- [ ] 사용자 설정 저장 기능
- [ ] 검색 결과 내보내기
- [ ] 다국어 지원 확장
- [ ] 웹 인터페이스 연동